<link rel="stylesheet" href=".\styles-updated.css">
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<div class="row" id="toprow">
<div id="miranda" class="toprow col2" onclick="changeDoorState('miranda')">
	<img class="door" src="doors/IMG_5244.PNG">
	<div id="portrait-wrapper"><img id="portrait" src="content/self-portrait-cropped.png"></div>
</div>
<div id="AboutContact" class="toprow col1 closed">
	<img class="door" src="doors/IMG_5245.PNG">
	<h1 id="bio-header" class="behind-text">Bio & Contact</h1>
	<div id="biooverlay" class="overlay bioclosed">
		<p id="bio-text">Miranda is an artist, game-changer with lots of experience and is very funny.</p>
		<form
		  action="https://formspree.io/xdowevpw"
		  method="POST"
		  id="contact"
		>
		  <label>
		    Your email:
		    <input type="text" name="email_address">
		  </label>
		  <br><br>
		  <label>
		    Your message:
		    <textarea name="message"></textarea>
		  </label>
		  <br><br>
		  <!-- your other form fields go here -->
		  <input type="hidden" name="_next" value="/" />

		  <button type="submit">Send</button>
		</form>
		<img class="x" src="content/x3.png" onclick="changeDoorState('AboutContact')">
	</div>
</div>
<div class="toprow closed col3" id="media">
	<img id="media-door" class="door" src="doors/IMG_5246.PNG">
	<h1 class="behind-text">Media</h1>
	<div id="mediaoverlay" class="overlay closed">
		<img class="x" src="content/x3.png" onclick="changeDoorState('media')">
	</div>
</div>
</div>
<div class="row" id="bottomrow">
<div id="bottomrow-div">
	<div class="bottomrow closed col1" id="film">
		<img id="film-door" class="door" src="doors/IMG_5242.PNG">
		<h1 class="behind-text">Film</h1>
		<div id="filmoverlay" class="overlay closed">
			<img class="x" src="content/x3.png" onclick="changeDoorState('film')">
		</div>
	</div>
	<div class="bottomrow closed col3" id="art">
		<img id="art-door" class="door" src="doors/IMG_5241.PNG">
		<h1 class="behind-text">Art</h1>
		<div id="artoverlay" class="overlay closed">
			<img class="x" src="content/x3.png" onclick="changeDoorState('art')">
		</div>
	</div>
	<div class="bottomrow closed col2" id="comedy">
		<img id="comedy-door" class="door" src="doors/IMG_5243.PNG">
		<h1 class="behind-text">Comedy</h1>
		<div id="comedyoverlay" class="overlay closed">
			<img class="x" src="content/x3.png" onclick="changeDoorState('comedy')">
		</div>
	</div>
</div>
</div>
<script>
	window.onload = function() {
	// First we get the viewport height and we multiple it by 1% to get a value for a vh unit
	//let vh = document.documentElement.clientHeight * 0.01;
	// Then we set the value in the --vh custom property to the root of the document
	//document.documentElement.style.setProperty('--vh', `${vh}px`);
	mobileBrowser = isMobile();
	console.log("browser is mobile: " + mobileBrowser);
	if (!mobileBrowser) {
		console.log("adding hover");
		addHover();
	}


	var depeek_time = 1400;
	  //miranda peekout
	  setTimeout(() => {switchClass('portrait-wrapper', 'peek')}, 300);
	  setTimeout(() => {switchClass('miranda', 'peek')}, 300);
	  setTimeout(() => {switchClassTwo('portrait-wrapper', 'peek', 'depeek')}, depeek_time);
	  setTimeout(() => {switchClassTwo('miranda', 'peek', 'depeek')}, depeek_time);
	  setTimeout(() => {switchClass('portrait-wrapper', 'depeek')}, 1600);
	  setTimeout(() => {switchClass('miranda', 'depeek')}, 1600);
	};

	let resizeTimer;
	window.addEventListener("resize", () => {
	  document.body.classList.add("resize-animation-stopper");
	  clearTimeout(resizeTimer);
	  resizeTimer = setTimeout(() => {
	    document.body.classList.remove("resize-animation-stopper");
	  }, 400);
	});

	var divs = {
		'miranda': document.getElementById('miranda'),
		'AboutContact': document.getElementById('AboutContact'),
		'media': document.getElementById('media'),
		'film': document.getElementById('film'),
		'art': document.getElementById('art'),
		'comedy': document.getElementById('comedy')
	};
	for (div in divs) {
		console.log(divs[div]);
		divs[div].addEventListener("click", function( e ) {
    		e = window.event || e; 
    		console.log("this");
    		console.log(this);
    		console.log("e");
    		console.log(e);
    		console.log("e.target");
    		console.log(e.target);
    		//if the click is targeting the div, or if the div isn't open (and the x button isn't being clicked, which can close the div before this listener fires, thus reopening it)
    		if (this === e.target || ((!(this.className.indexOf('open') >= 0)) && (!(e.target.className === "x")))) {
    			console.log("passed");
       			changeDoorState(this.id);
   			}
		});
	}

	mobileStates = ["closed", "ajar", "open"];


	function addHover() {
		var divs = {
			'miranda': document.getElementById('miranda'),
			'AboutContact': document.getElementById('AboutContact'),
			'media': document.getElementById('media'),
			'film': document.getElementById('film'),
			'art': document.getElementById('art'),
			'comedy': document.getElementById('comedy')
		};
		for (div in divs) {
			divs[div].className = divs[div].className + " " + "hover";
		}
	};

	div_timers = {
		'miranda': '',
		'AboutContact': '',
		'media': '',
		'film': '',
		'art': '',
		'comedy': ''
	};
	function changeDoorState(category, reset) {
		var cat_div = document.getElementById(category);

		console.log(cat_div);
		console.log(cat_div.className);

		if (category === "miranda") {
			cat_div.className = cat_div.className + " " + "ajar";
			div_timers[category] = setTimeout(() => {cat_div.className = cat_div.className.replace('ajar', '');}, 1500);
		}
		else if (mobileBrowser) {
			if (reset) {
				cat_div.className = cat_div.className.replace("ajar", "closed");
			} else if (cat_div.className.indexOf("closed") >= 0) {
				cat_div.className = cat_div.className.replace("closed", "ajar");
				div_timers[category] = setTimeout(() => {changeDoorState(category, true)}, 1500);
			} else if (cat_div.className.indexOf("ajar") >= 0) {
				cat_div.className = cat_div.className.replace("ajar", "open");
				clearTimeout(div_timers[category]);
			} else if (cat_div.className.indexOf("open") >= 0) {
				cat_div.className = cat_div.className.replace("open", "closed");
			}

		} else {
			if (cat_div.className.indexOf("closed") >= 0) {
				console.log("changed to open");
				console.log(cat_div.className.indexOf("closed"));
				cat_div.className = cat_div.className.replace("closed", "open");
			} else {
				console.log("changed to closed");
				cat_div.className = cat_div.className.replace("open", "closed");
			}
		}

	};

	function switchClass(element, classAdd) {
		var el = document.getElementById(element);
		console.log(el);
		if (el.className.indexOf(classAdd) >= 0) {
			el.className = el.className.replace(classAdd, '');
		} else {
			el.className = el.className + " " + classAdd;
		}
	};

	function switchClassTwo(element, classRegName, classActivatedName) {
		function internal(element, classRegName, classActivatedName) {
			var el = document.getElementById(element);
			if (el.className.indexOf(classRegName) >= 0) {
				el.className = el.className.replace(classRegName, classActivatedName);
			} else {
				el.className = el.className.replace(classActivatedName, classRegName);
			}
		};

		if (element.forEach !== undefined) {
			element.forEach((el) => {internal(el, classRegName, classActivatedName);});
		} else {
			internal(element, classRegName, classActivatedName);
		}
	};

	function isMobile() {
	  try{ document.createEvent("TouchEvent"); return true; }
	  catch(e){ return false; }
	}
</script>